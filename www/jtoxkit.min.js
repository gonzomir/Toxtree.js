var ccLib={extendArray:function(base,arr){if(base===undefined||base==null)
base=[];else if(!$.isArray(base))
base=[base];if(arr!==undefined&&arr!==null){for(var i=0,al=arr.length;i<al;++i){var v=arr[i];if(base.indexOf(v)<0&&v!==undefined&&v!=null)
base.push(v);}}
return base;},fireCallback:function(callback,self){if(typeof callback!='function')
callback=window[callback];return callback.apply((self!==undefined&&self!=null)?self:document,Array.prototype.slice.call(arguments,2));},setObjValue:function(obj,value){if((value===undefined||value===null)&&$(obj).data('default')!==undefined)
value=$(obj).data('default');if(obj.nodeName=="INPUT"||obj.nodeName=="SELECT")
obj.value=value;else if(obj.nodeName=="IMG")
obj.src=value;else if(obj.nodeName=="BUTTON")
$(obj).data('value',value);else
obj.innerHTML=value;},isNull:function(obj){return obj===undefined||obj==null;},isEmpty:function(obj){var empty=true;if(obj!==undefined||obj!=null){if(typeof obj=='object'){for(var i in obj){if(obj[i]!=null){empty=false;break;}}}
else if(typeof obj=='string')
empty=obj.trim().length==0;else if($.isArray(obj))
empty=obj.length==0;else
empty=false;}
return empty;},enumObject:function(obj,fn,idx,level){if(level==null)
level=0;if(typeof obj!="object")
fn(obj,idx,level);else
for(var i in obj)
this.enumObject(obj[i],fn,i,level+1);},setJsonValue:function(json,field,val){if(field!==undefined){try{eval("json."+field+" = val");}
catch(e){;}}},getJsonValue:function(json,field){var value=undefined;if(field!==undefined){try{eval("value = json."+field);}
catch(e){;}}
return value;},fillTree:function(root,json,prefix,filter){var self=this;if(!filter)
filter='data-field';var processFn=function(el,json){var value=self.getJsonValue(json,$(el).data('field'));if(value!==undefined){var format=$(el).data('format');if(!!format&&(typeof window[format]=='function')){value=window[format](value,json);}
self.setObjValue(el,value);}}
if($(root).hasClass(filter))
processFn(root,json);$('.'+filter,root).each(function(i){processFn($(this)[0],json);});if(prefix&&json.id!==undefined){root.id=prefix+json.id;}},clearChildren:function(obj,last){while(obj.lastChild&&obj.lastChild!=last){obj.removeChild(obj.lastChild);}},formatString:function(format){for(var i=1;i<arguments.length;++i){format=format.replace('<'+i+'>',arguments[i]);}
return format;},trim:function(obj){if(obj===undefined||obj==null)
return'';if(typeof obj=="string")
return obj.trim();else
return obj;},copyToClipboard:function(text,prompt){if(!prompt){prompt="Press Ctrl-C (Command-C) to copy and then Enter.";}
window.prompt(prompt,text);},equalizeHeights:function(){var tabs=[];for(var i=0;i<arguments.length;++i){tabs[i]=arguments[i].firstElementChild;}
for(;;){var height=0;for(i=0;i<tabs.length;++i){if(tabs[i]==null)
continue;if(!$(tabs[i]).hasClass('lock-height')&&tabs[i].style.height!='')
tabs[i].style.height="auto";if(tabs[i].offsetHeight>height)
height=tabs[i].offsetHeight;}
if(height==0)
break;for(i=0;i<tabs.length;++i){if(tabs[i]!=null){if(tabs[i].offsetHeight<height)
$(tabs[i]).height(height);tabs[i]=tabs[i].nextElementSibling;}}}},addParameter:function(url,param){return url+(url.indexOf('?')>0?"&":"?")+encodeURIComponent(param);},removeParameter:function(url,param){return url.replace(new RegExp('(.*\?.*)('+param+'=[^\&\s$]*\&?)(.*)'),'$1$3');},parseURL:function(url){var a=document.createElement('a');a.href=url;return{source:url,protocol:a.protocol.replace(':',''),host:a.hostname,port:a.port,query:a.search,params:(function(){var ret={},seg=a.search.replace(/^\?/,'').split('&'),len=seg.length,i=0,s,v,arr;for(;i<len;i++){if(!seg[i]){continue;}
s=seg[i].split('=');v=(s.length>1)?decodeURIComponent(s[1].replace(/\+/g," ")):'';if(s[0].indexOf('[]')==s[0].length-2){arr=ret[s[0].slice(0,-2)];if(arr===undefined)
ret[s[0].slice(0,-2)]=[v];else
arr.push(v);}
else
ret[s[0]]=v;}
return ret;})(),file:(a.pathname.match(/\/([^\/?#]+)$/i)||[,''])[1],hash:a.hash.replace('#',''),path:a.pathname.replace(/^([^\/])/,'/$1'),relative:(a.href.match(/tps?:\/\/[^\/]+(.+)/)||[,''])[1],segments:a.pathname.replace(/^\//,'').split('/')};}};function ccNonEmptyFilter(v){return v!==undefined&&v!=null&&v!='';}
var jToxDataset=(function(){var defaultSettings={"showTabs":true,"showExport":true,"showControls":true,"pageSize":20,"pageStart":0,"metricFeature":"http://www.opentox.org/api/1.1#Similarity","configuration":{"groups":{"Identifiers":["http://www.opentox.org/api/1.1#Diagram","http://www.opentox.org/api/1.1#CASRN","http://www.opentox.org/api/1.1#EINECS","http://www.opentox.org/api/1.1#IUCLID5_UUID"],"Names":["http://www.opentox.org/api/1.1#ChemicalName","http://www.opentox.org/api/1.1#TradeName","http://www.opentox.org/api/1.1#IUPACName","http://www.opentox.org/api/1.1#SMILES","http://www.opentox.org/api/1.1#InChIKey","http://www.opentox.org/api/1.1#InChI","http://www.opentox.org/api/1.1#REACHRegistrationDate"],"Calculated":function(name,miniset){var arr=[];if(!ccLib.isNull(miniset.dataEntry[0].compound.metric))
arr.push(this.settings.metricFeature);for(var f in miniset.features){var feat=miniset.features[f];if(ccLib.isNull(feat.source)||ccLib.isNull(feat.source.type))
continue;else if(feat.source.type.toLowerCase()=="algorithm"||feat.source.type.toLowerCase()=="model"){feat.used=true;arr.push(f);}}
return arr;},"Other":function(name,miniset){var arr=[];for(var f in miniset.features){if(!miniset.features[f].used)
arr.push(f);}
return arr;}},"exports":[{type:"chemical/x-mdl-sdfile",icon:"images/sdf.jpg"},{type:"chemical/x-cml",icon:"images/cml.jpg"},{type:"chemical/x-daylight-smiles",icon:"images/smi.png"},{type:"chemical/x-inchi",icon:"images/inchi.png"},{type:"text/uri-list",icon:"images/link.png"},{type:"application/pdf",icon:"images/pdf.png"},{type:"text/csv",icon:"images/excel.png"},{type:"text/plain",icon:"images/excel.png"},{type:"text/x-arff",icon:"images/weka.png"},{type:"text/x-arff-3col",icon:"images/weka.png"},{type:"application/rdf+xml",icon:"images/rdf.gif"},{type:"application/json",icon:"images/json.png"}],"baseFeatures":{"http://www.opentox.org/api/1.1#Diagram":{title:"Diagram",search:false,used:true,process:function(entry){entry.compound.diagramUri=entry.compound.URI.replace(/(.+)(\/conformer.*)/,"$1")+"?media=image/png";},render:function(col){col["mData"]="compound.diagramUri";col["mRender"]=function(data,type,full){return(type!="display")?"-":'<a target="_blank" href="'+full.compound.URI+'"><img src="'+data+'" class="jtox-ds-smalldiagram"/></a>';};col["sClass"]="paddingless";col["sWidth"]="125px";return col;}},"http://www.opentox.org/api/1.1#Similarity":{title:"Similarity",accumulate:"compound.metric",search:true,used:true},}}};var baseFeatures={"http://www.opentox.org/api/1.1#REACHRegistrationDate":{title:"REACH Date",accumulate:"compound.reachdate",used:true},"http://www.opentox.org/api/1.1#CASRN":{title:"CAS",accumulate:"compound.cas",used:true},"http://www.opentox.org/api/1.1#ChemicalName":{title:"Name",accumulate:"compound.name",used:true},"http://www.opentox.org/api/1.1#TradeName":{title:"Trade Name",accumulate:"compound.tradename",used:true},"http://www.opentox.org/api/1.1#IUPACName":{title:"IUPAC Name",accumulate:["compound.name","compound.iupac"],used:true},"http://www.opentox.org/api/1.1#EINECS":{title:"EINECS",accumulate:"compound.einecs",used:true},"http://www.opentox.org/api/1.1#InChI":{title:"InChI",accumulate:"compound.inchi",used:true,shorten:true},"http://www.opentox.org/api/1.1#InChI_std":{title:"InChI",accumulate:"compound.inchi",used:true,shorten:true},"http://www.opentox.org/api/1.1#InChIKey":{title:"InChI Key",accumulate:"compound.inchikey",used:true},"http://www.opentox.org/api/1.1#InChIKey_std":{title:"InChI Key",accumulate:"compound.inchikey",used:true},"http://www.opentox.org/api/1.1#InChI_AuxInfo":{title:"InChI Aux",accumulate:"compound.inchi",used:true},"http://www.opentox.org/api/1.1#InChI_AuxInfo_std":{title:"InChI Aux",accumulate:"compound.inchi",used:true},"http://www.opentox.org/api/1.1#IUCLID5_UUID":{title:"IUCLID5 UUID",accumulate:"compound.i5uuid",used:true,shorten:true},"http://www.opentox.org/api/1.1#SMILES":{title:"SMILES",accumulate:"compound.smiles",used:true,shorten:true},"http://www.opentox.org/api/dblinks#CMS":{title:"CMS",used:true},"http://www.opentox.org/api/dblinks#ChEBI":{title:"ChEBI",used:true},"http://www.opentox.org/api/dblinks#Pubchem":{title:"Public Chem",used:true},"http://www.opentox.org/api/dblinks#ChemSpider":{title:"Chem Spider",used:true},"http://www.opentox.org/api/dblinks#ChEMBL":{title:"ChEMBL",used:true},"http://www.opentox.org/api/dblinks#ToxbankWiki":{title:"Toxban Wiki",used:true},};var instanceCount=0;var cls=function(root,settings){var self=this;self.rootElement=root;var newDefs=$.extend(true,{"configuration":{"baseFeatures":baseFeatures}},defaultSettings);self.settings=$.extend(true,{},newDefs,jToxKit.settings,settings);self.features=null;self.dataset=null;self.groups=null;self.fixTable=self.varTable=null;self.instanceNo=instanceCount++;self.entriesCount=null;self.suspendEqualization=false;self.orderList=[];root.appendChild(jToxKit.getTemplate('#jtox-dataset'));var pane=$('.jtox-ds-control',self.rootElement)[0];if(self.settings.showControls){ccLib.fillTree(pane,{"pagesize":self.settings.pageSize});$('.next-field',pane).on('click',function(){self.nextPage();});$('.prev-field',pane).on('click',function(){self.prevPage();});$('select',pane).on('change',function(){self.queryEntries(self.settings.pageStart,parseInt($(this).val()));})
var pressTimeout=null;$('input',pane).on('keydown',function(){if(pressTimeout!=null)
clearTimeout(pressTimeout);pressTimeout=setTimeout(function(){self.updateTables();},350);});}
else
pane.style.display="none";if(self.settings['datasetUri']!==undefined){self.queryDataset(self.settings['datasetUri']);}};cls.prototype={prepareTabs:function(root,isMain,nodeFn,divFn){var self=this;var all=document.createElement('div');all.style.display="none";root.appendChild(all);ulEl=document.createElement('ul');all.appendChild(ulEl);var createATab=function(grId,name){var liEl=document.createElement('li');ulEl.appendChild(liEl);var aEl=document.createElement('a');aEl.href="#"+grId;aEl.innerHTML=name;liEl.appendChild(aEl);return liEl;};var emptyList=[];var idx=0;for(var gr in self.groups){var grId="jtox-ds-"+gr+"-"+self.instanceNo;createATab(grId,gr.replace(/_/g," "));var divEl=document.createElement('div');divEl.id=grId;all.appendChild(divEl);if(typeof divFn=='function')
divEl=divFn(gr,divEl);var grp=self.groups[gr];var empty=true;ccLib.enumObject(self.groups[gr],function(fId,idx,level){empty=false;if(idx=="name"){if(isMain)
nodeFn(null,fId,divEl);}
else if(!isMain||level==1){var title=self.features[fId].title;if(!ccLib.isNull(title))
nodeFn(fId,title,divEl);}});if(empty)
emptyList.push(idx);++idx;}
if(isMain&&self.settings.showExport){var tabId="jtox-ds-export-"+self.instanceNo;var liEl=createATab(tabId,"Export");$(liEl).addClass('jtox-ds-export');var divEl=jToxKit.getTemplate('#jtox-ds-export')
divEl.id=tabId;all.appendChild(divEl);divEl=$('.jtox-exportlist',divEl)[0];for(var i=0,elen=self.settings.configuration.exports.length;i<elen;++i){var expo=self.settings.configuration.exports[i];var el=jToxKit.getTemplate('#jtox-ds-download');divEl.appendChild(el);$('a',el)[0].href=ccLib.addParameter(self.datasetUri,"media="+expo.type);var img=el.getElementsByTagName('img')[0];img.alt=img.title=expo.type;img.src=self.baseUrl+expo.icon;}}
all.style.display="block";return $(all).tabs({collapsible:isMain,disabled:emptyList,heightStyle:isMain?"content":"fill"});},equalizeTables:function(){var self=this;if(!self.suspendEqualization&&self.fixTable!=null&&self.varTable!=null){ccLib.equalizeHeights(self.fixTable.tHead,self.varTable.tHead);ccLib.equalizeHeights(self.fixTable.tBodies[0],self.varTable.tBodies[0]);}},featureValue:function(fId,data){var self=this;var feature=self.features[fId];if(feature.accumulate!==undefined)
return ccLib.getJsonValue(data,feature.accumulate)
else
return data.values[fId];},prepareTables:function(){var self=this;var varCols=[];var fixCols=[];var colList=fixCols;fixCols.push({"mData":"number","sClass":"middle","mRender":function(data,type,full){return(type!="display")?''+data:"&nbsp;-&nbsp;"+data+"&nbsp;-&nbsp;<br/>"+
'<span class="jtox-details-open ui-icon ui-icon-circle-triangle-e" title="Press to open/close detailed info for the entry"></span>';}},{"sClass":"jtox-hidden","mData":"index","sDefaultContent":"-","bSortable":true,"mRender":function(data,type,full){return ccLib.isNull(self.orderList)?0:self.orderList[data];}},{"sClass":"jtox-hidden jtox-ds-details paddingless","mData":"index","sDefaultContent":"-","mRender":function(data,type,full){return'';}});varCols.push({"sClass":"jtox-hidden jtox-ds-details paddingless","mData":"index","mRender":function(data,type,full){return'';}});var fnShowColumn=function(sel,idx){return function(){var cells=$(sel+' table tr>*:nth-child('+(idx+1)+')',self.rootElement);if(this.checked)
$(cells).show();else
$(cells).hide();self.equalizeTables();}};var fnExpandCell=function(cell,expand){var cnt=0;for(var c=cell;c;c=c.nextElementSibling,++cnt)
$(c).toggleClass('jtox-hidden');if(expand)
cell.setAttribute('colspan',''+cnt);else
cell.removeAttribute('colspan');};var fnShowDetails=function(row){var cell=$(".jtox-ds-details",row)[0];var idx=$(row).data('jtox-index');$(row).toggleClass('jtox-detailed-row');var toShow=$(row).hasClass('jtox-detailed-row');fnExpandCell(cell,toShow);var varCell=document.getElementById('jtox-var-'+self.instanceNo+'-'+idx).firstElementChild;fnExpandCell(varCell,toShow);var iconCell=$('.jtox-details-open',row);$(iconCell).toggleClass('ui-icon-circle-triangle-e');$(iconCell).toggleClass('ui-icon-circle-triangle-w');if(toShow){var full=self.dataset.dataEntry[idx];var detDiv=document.createElement('div');varCell.appendChild(detDiv);var img=new Image();img.onload=function(e){self.equalizeTables();$(detDiv).height(varCell.parentNode.clientHeight-1);self.prepareTabs(detDiv,false,function(id,name,parent){var fEl=null;if(id!=null&&cls.shortFeatureId(id)!="Diagram"){fEl=jToxKit.getTemplate('#jtox-one-detail');parent.appendChild(fEl);ccLib.fillTree(fEl,{title:name,value:self.featureValue(id,full)});}
return fEl;},function(id,parent){var tabTable=jToxKit.getTemplate('#jtox-details-table');parent.appendChild(tabTable);return tabTable;});};img.src=full.compound.diagramUri;cell.appendChild(img);}
else{$(cell).empty();$(varCell).empty();self.equalizeTables();}};var checkList=$('.jtox-ds-features .jtox-checkbox',self.rootElement);var checkIdx=-1;for(var gr in self.groups){ccLib.enumObject(self.groups[gr],function(fId,idx,level){if(idx=="name"){++checkIdx;return;}
var feature=self.features[fId];var col={"sTitle":feature.title.replace(/_/g,' ')+(ccLib.isNull(feature.units)?"":feature.units),"sDefaultContent":"-",};if(feature.accumulate!==undefined)
col["mData"]=feature.accumulate;else{col["mData"]='values';col["mRender"]=(function(featureId){return function(data,type,full){var val=data[featureId];return ccLib.isEmpty(val)?'-':val};})(fId);}
if(feature.render!==undefined)
col=ccLib.fireCallback(feature.render,self,col);if(!!feature.shorten){col["mRender"]=function(data,type,full){return(type!="display")?''+data:jToxKit.shortenedData(data,"Press to copy the value in the clipboard");};col["sWidth"]="75px";}
if(level==1)
++checkIdx;$(checkList[checkIdx]).on('change',fnShowColumn(colList==fixCols?'.jtox-ds-fixed':'.jtox-ds-variable',colList.length))
colList.push(col);});colList=varCols;}
self.fixTable=($(".jtox-ds-fixed table",self.rootElement).dataTable({"bPaginate":false,"bProcessing":true,"bLengthChange":false,"bAutoWidth":true,"sDom":"rt","aoColumns":fixCols,"bSort":false,"fnCreatedRow":function(nRow,aData,iDataIndex){$('.jtox-details-open',nRow).on('click',function(e){fnShowDetails(nRow);});$(nRow).data('jtox-index',iDataIndex);},"oLanguage":{"sEmptyTable":'<span id="jtox-ds-message-'+self.instanceNo+'">Loading data...</span>',}}))[0];self.varTable=($(".jtox-ds-variable table",self.rootElement).dataTable({"bPaginate":false,"bLengthChange":false,"bAutoWidth":false,"sDom":"rt","bSort":true,"aoColumns":varCols,"bScrollCollapse":true,"fnCreatedRow":function(nRow,aData,iDataIndex){nRow.id='jtox-var-'+self.instanceNo+'-'+iDataIndex;$(nRow).addClass('jtox-row');$(nRow).data('jtox-index',iDataIndex);},"fnDrawCallback":function(oSettings){var sorted=$('.jtox-row',this);for(var i=0,rlen=sorted.length;i<rlen;++i){var idx=$(sorted[i]).data('jtox-index');self.orderList[idx]=i;}
if(rlen>0)
$(self.fixTable).dataTable().fnSort([[1,"asc"]]);},"oLanguage":{"sEmptyTable":" - "}}))[0];},updateTables:function(){var self=this;self.filterEntries($('.jtox-ds-control input',self.rootElement).val());},prepareGroups:function(miniset){var self=this;var grps=self.settings.configuration.groups;self.groups={};for(var i in grps){var grp=grps[i];var grpArr=(typeof grp=="function"||typeof grp=="string")?ccLib.fireCallback(grp,self,i,miniset):grp;self.groups[i]=grpArr;ccLib.enumObject(grpArr,function(fid,idx){if(idx!="name")self.features[fid].used=true;})}},enumerateFeatures:function(fnMatch){var self=this;var stopped=false;for(var gr in self.groups){for(var i=0,glen=self.groups[gr].length;i<glen;++i){if(stopped=fnMatch(self.groups[gr][i],gr))
break;}
if(stopped)
break;}
return stopped;},filterEntries:function(needle){var self=this;if(ccLib.isNull(needle))
needle='';else
needle=needle.toLowerCase();var dataFeed=[];if(needle!=''){for(var i=0,slen=self.dataset.dataEntry.length;i<slen;++i){var entry=self.dataset.dataEntry[i];var match=self.enumerateFeatures(function(fId,gr){var feat=self.features[fId];if(feat.search!==undefined&&!feat.search)
return false;var val=self.featureValue(fId,entry);return!ccLib.isNull(val)&&val.toString().toLowerCase().indexOf(needle)>=0;});if(match)
dataFeed.push(entry);}}
else{dataFeed=self.dataset.dataEntry;}
$(self.fixTable).dataTable().fnClearTable();$(self.varTable).dataTable().fnClearTable();$(self.fixTable).dataTable().fnAddData(dataFeed);$(self.varTable).dataTable().fnAddData(dataFeed);$('#jtox-ds-message-'+self.instanceNo).html('No records matching the filter.');if(self.settings.showTabs){self.suspendEqualization=true;$('.jtox-ds-features .jtox-checkbox',self.rootElement).trigger('change');self.suspendEqualization=false;}
self.equalizeTables();},nextPage:function(){var self=this;if(self.entriesCount===null||self.settings.pageStart+self.settings.pageSize<self.entriesCount)
self.queryEntries(self.settings.pageStart+self.settings.pageSize);},prevPage:function(){var self=this;if(self.settings.pageStart>0)
self.queryEntries(self.settings.pageStart-self.settings.pageSize);},queryEntries:function(from,size,fnComplete){var self=this;if(from<0)
from=0;if(size==null)
size=self.settings.pageSize;$('.jtox-ds-control select',self.rootElement).val(size);self.settings.pageSize=size;var qStart=Math.floor(from/size);var qUri=ccLib.addParameter(self.datasetUri,"page="+qStart+"&pagesize="+size);jToxKit.call(self,qUri,function(dataset){if(!!dataset){var qSize=dataset.dataEntry.length;qStart=self.settings.pageStart=qStart*self.settings.pageSize;if(qSize<self.settings.pageSize)
self.entriesCount=qStart+qSize;self.dataset=cls.processDataset(dataset,self.features,function(oldVal,newVal){if(ccLib.isNull(oldVal)||newVal.toLowerCase().indexOf(oldVal.toLowerCase())>=0)
return newVal;if(oldVal.toLowerCase().indexOf(newVal.toLowerCase())>=0)
return oldVal;return oldVal+", "+newVal;},self.settings.pageStart);self.updateTables();if(self.settings.showControls){var pane=$('.jtox-ds-control',self.rootElement)[0];ccLib.fillTree(pane,{"pagestart":qStart+1,"pageend":qStart+qSize,});var nextBut=$('.next-field',pane);if(self.entriesCount===null||qStart+qSize<self.entriesCount)
$(nextBut).addClass('paginate_enabled_next').removeClass('paginate_disabled_next');else
$(nextBut).addClass('paginate_disabled_next').removeClass('paginate_enabled_next');var prevBut=$('.prev-field',pane);if(qStart>0)
$(prevBut).addClass('paginate_enabled_previous').removeClass('paginate_disabled_previous');else
$(prevBut).addClass('paginate_disabled_previous').removeClass('paginate_enabled_previous');}
if(typeof fnComplete=='function')
fnComplete();}});},queryDataset:function(datasetUri){var self=this;var urlObj=ccLib.parseURL(datasetUri);if(urlObj.params['pagesize']!==undefined){var sz=parseInt(urlObj.params['pagesize']);if(sz>0)
self.settings.pageSize=sz;datasetUri=ccLib.removeParameter(datasetUri,'pagesize');}
if(urlObj.params['page']!==undefined){var beg=parseInt(urlObj.params['page']);if(beg>=0)
self.settings.pageStart=beg*self.settings.pageSize;datasetUri=ccLib.removeParameter(datasetUri,'page');}
self.baseUrl=ccLib.isNull(self.settings.baseUrl)?jToxKit.grabBaseUrl(datasetUri):self.settings.baseUrl;self.datasetUri=datasetUri;jToxKit.call(self,ccLib.addParameter(datasetUri,"page=0&pagesize=1"),function(dataset){if(!!dataset){self.features=dataset.feature;cls.processFeatures(self.features,self.settings.configuration.baseFeatures);dataset.features=self.features;self.prepareGroups(dataset);if(self.settings.showTabs){self.prepareTabs($('.jtox-ds-features',self.rootElement)[0],true,function(id,name,parent){var fEl=jToxKit.getTemplate('#jtox-ds-feature');parent.appendChild(fEl);ccLib.fillTree(fEl,{title:name.replace(/_/g,' ')});return fEl;});}
self.prepareTables();self.equalizeTables();self.queryEntries(self.settings.pageStart,self.settings.pageSize);}});},};cls.shortFeatureId=function(fId){return fId.substr(fId.indexOf('#')+1);};cls.processEntry=function(entry,features,fnValue){for(var fid in features){var feature=features[fid];if(entry.values[fid]!==undefined&&feature.accumulate!==undefined){var accArr=feature.accumulate;if(!$.isArray(accArr))
accArr=[accArr];for(var v=0;v<accArr.length;++v){var oldVal=ccLib.getJsonValue(entry,accArr[v]);var newVal=entry.values[fid];if(typeof fnValue==="function")
ccLib.setJsonValue(entry,accArr[v],fnValue(oldVal,newVal));else if(!$.isArray(oldVal))
ccLib.setJsonValue(entry,accArr[v],ccLib.isNull(oldVal)?newVal:oldVal+newVal);else
oldVal.push(newVal);}}
if(feature.process!==undefined)
ccLib.fireCallback(feature.process,self,entry,fid);}
return entry;};cls.processFeatures=function(features,bases){if(bases==null)
base=baseFeatures;features=$.extend(features,bases);for(var fid in features){var feature=features[fid];var base=fid.replace(/(http.+\/feature\/).*/g,"$1");for(;;){if(feature.sameAs===undefined||feature.sameAs==null||feature.sameAs==fid||fid==base+feature.sameAs)
break;if(features[feature.sameAs]!==undefined)
feature=features[feature.sameAs];else{if(features[base+feature.sameAs]!==undefined)
feature=features[base+feature.sameAs];else
break;}}
features[fid]=$.extend(features[fid],feature);}
return features;};cls.processDataset=function(dataset,features,fnValue,startIdx){if(ccLib.isNull(features)){cls.processFeatures(dataset.feature);features=dataset.feature;}
if(!startIdx)
startIdx=0;for(var i=0,dl=dataset.dataEntry.length;i<dl;++i){cls.processEntry(dataset.dataEntry[i],features,fnValue);dataset.dataEntry[i].number=i+1+startIdx;dataset.dataEntry[i].index=i;}
return dataset;};return cls;})();var jToxStudy=(function(){var defaultSettings={configuration:{columns:{"main":{},"parameters":{},"conditions":{},"effects":{},"protocol":{},"interpretation":{}}}};var instanceCount=0;var fnDatasetValue=function(old,value){return ccLib.extendArray(old,value!=null?value.trim().toLowerCase().split("|"):[value]).filter(ccNonEmptyFilter);};var cls=function(root,settings){var self=this;self.rootElement=root;self.suffix='_'+instanceCount++;self.settings=$.extend({},defaultSettings,jToxKit.settings,settings);var tree=jToxKit.getTemplate('#jtox-studies');root.appendChild(tree);jToxKit.changeTabsIds(tree,self.suffix);var loadPanel=function(panel){if(panel){$('.jtox-study.unloaded',panel).each(function(i){var table=this;jToxKit.call(self,$(table).data('jtox-uri'),function(study){if(!!study){$(table).removeClass('unloaded folded');$(table).addClass('loaded');self.processStudies(panel,study.study,false);}});});}};$(tree).tabs({"select":function(event,ui){loadPanel(ui.panel);},"beforeActivate":function(event,ui){if(ui.newPanel)
loadPanel(ui.newPanel[0]);}});if(self.settings['substanceUri']!==undefined){self.querySubstance(self.settings['substanceUri']);}};cls.prototype={getFormatted:function(data,type,format){var value=null;if(typeof format==='function')
value=format.call(this,data,type);else if(typeof format==='string'||typeof format==='number')
value=data[format];else
value=data[0];return value;},renderMulti:function(data,type,full,format){var self=this;var dlen=data.length;if(dlen<2)
return self.getFormatted(data[0],type,format);var height=100/dlen;var df='<table>';for(var i=0,dlen=data.length;i<dlen;++i){df+='<tr class="'+(i%2==0?'even':'odd')+'"><td class="center" style="height: '+height+'%">'+self.getFormatted(data[i],type,format)+'</td></tr>';}
df+='</table>';return df;},createCategory:function(tab,category){var self=this;var theCat=$('.'+category+'.jtox-study',tab)[0];if(!theCat){theCat=jToxKit.getTemplate('#jtox-study');tab.appendChild(theCat);$(theCat).addClass(category);$('.jtox-study-title',theCat).click(function(){$(theCat).toggleClass('folded');});}
return theCat;},updateCount:function(str,count){if(count===undefined)
count=0;return str.replace(/(.+)\s\(([0-9]+)\)/,"$1 ("+count+")");},ensureTable:function(tab,study){var self=this;var defaultColumns=[{"sTitle":"Name","sClass":"center middle","sWidth":"20%","mData":"protocol.endpoint"},{"sTitle":"Endpoint","sClass":"center middle jtox-multi","sWidth":"15%","mData":"effects","mRender":function(data,type,full){return self.renderMulti(data,type,full,"endpoint");}},{"sTitle":"Result","sClass":"center middle jtox-multi","sWidth":"15%","mData":"effects","mRender":function(data,type,full){return self.renderMulti(data,type,full,function(data,type){return formatLoHigh(data.result,type)})}},{"sTitle":"Guideline","sClass":"center middle","sWidth":"15%","mData":"protocol.guideline","mRender":"[,]","sDefaultContent":"?"},{"sTitle":"Owner","sClass":"center middle shortened","sWidth":"50px","mData":"owner.company.name","sDefaultContent":"?"},{"sTitle":"UUID","sClass":"center middle","sWidth":"50px","mData":"uuid","bSearchable":false,"mRender":function(data,type,full){return type!="display"?''+data:jToxKit.shortenedData(data,"Press to copy the UUID in the clipboard");}}];var category=study.protocol.category.code;var theTable=$('.'+category+' .jtox-study-table',tab)[0];if(!$(theTable).hasClass('dataTable')){var colDefs=[];var parCount=0;var modifyColumn=function(col,group){if(group==null)
group="main";var name=col.sTitle.toLowerCase();var getColDef=function(cat){var catCol=self.settings.configuration.columns[cat];if(!ccLib.isNull(catCol)){catCol=catCol[group];if(!ccLib.isNull(catCol))
catCol=catCol[name];}
if(ccLib.isNull(catCol))
catCol={};return catCol;};col=$.extend(col,getColDef('_'),getColDef(category));return ccLib.isNull(col.bVisible)||col.bVisible?col:null;};var putAGroup=function(group,fProcess){var count=0;var skip=[];for(var p in group){if(skip.indexOf(p)>-1)
continue;if(group[p+" unit"]!==undefined)
skip.push(p+" unit");var val=fProcess(p);if(ccLib.isNull(val))
continue;colDefs.push(val);count++;}
return count;}
var putDefaults=function(start,len,group){for(var i=0;i<len;++i){var col=$.extend({},defaultColumns[i+start]);col=modifyColumn(col,group);if(col!=null)
colDefs.push(col);}};var formatLoHigh=function(data,type){var out="";if(!ccLib.isNull(data)){data.loValue=ccLib.trim(data.loValue);data.upValue=ccLib.trim(data.upValue);if(!ccLib.isEmpty(data.loValue)&&!ccLib.isEmpty(data.upValue)){out+=(data.loQualifier==">=")?"[":"(";out+=data.loValue+", "+data.upValue;out+=(data.upQualifier=="<=")?"]":") ";}
else
{var fnFormat=function(q,v){return(!!q?q:"=")+" "+v;};if(!ccLib.isEmpty(data.loValue))
out+=fnFormat(data.loQualifier,data.loValue);else if(!ccLib.isEmpty(data.upValue))
out+=fnFormat(data.upQualifier,data.upValue);else
out+='-';}
out+=(data.unit=ccLib.trim(data.unit));}
return out.replace(/ /g,"&nbsp;");};var formatUnits=function(data,unit){data=ccLib.trim(data);unit=ccLib.trim(unit);return!ccLib.isNull(data)?(data+(!!unit?"&nbsp;"+unit:"")):"-";};putDefaults(0,1,"main");putAGroup(study.parameters,function(p){if(study.effects[0].conditions[p]!==undefined||study.effects[0].conditions[p+" unit"]!==undefined)
return undefined;var col={"sTitle":p,"sClass":"center middle","mData":"parameters."+p,"sDefaultContent":"-"};col=modifyColumn(col,"parameters");if(col==null)
return null;if(study.parameters[p]!==undefined&&study.parameters[p]!=null){col["mRender"]=study.parameters[p].loValue===undefined?function(data,type,full){return formatUnits(data,full[p+" unit"]);}:function(data,type,full){return formatLoHigh(data.parameters[p],type);};}
return col;});putAGroup(study.effects[0].conditions,function(c){var col={"sTitle":c,"sClass":"center middle jtox-multi","mData":"effects"};col=modifyColumn(col,"conditions");if(col==null)
return null;var rnFn=null;if(study.effects[0].conditions[c]!==undefined&&study.effects[0].conditions[c]!=null)
rnFn=study.effects[0].conditions[c].loValue===undefined?function(data,type){return formatUnits(data.conditions[c],data.conditions[c+" unit"]);}:function(data,type){return formatLoHigh(data.conditions[c],type);}
else
rnFn=function(data,type){return"-";}
col["mRender"]=function(data,type,full){return self.renderMulti(data,type,full,rnFn);};return col;});putDefaults(1,2,"effects");putAGroup(study.interpretation,function(i){var col={"sTitle":i,"sClass":"center middle jtox-multi","mData":"interpretation."+i,"sDefaultContent":"-"};return modifyColumn(col,"interpretation");});putDefaults(3,3,"protocol");colDefs.sort(function(a,b){var valA=ccLib.isNull(a.iOrder)?0:a.iOrder;var valB=ccLib.isNull(b.iOrder)?0:b.iOrder;return valA-valB;});$(theTable).dataTable({"bPaginate":true,"bProcessing":true,"bLengthChange":false,"bAutoWidth":false,"sDom":"rt<Fip>","aoColumns":colDefs,"fnInfoCallback":function(oSettings,iStart,iEnd,iMax,iTotal,sPre){var el=$('.jtox-study-title .data-field',$(this).parents('.jtox-study'))[0];el.innerHTML=self.updateCount(el.innerHTML,iTotal);return sPre;},"oLanguage":{"sProcessing":"<img src='"+self.baseUrl+"images/24x24_ambit.gif' border='0'>","sLoadingRecords":"No studies found.","sZeroRecords":"No studies found.","sEmptyTable":"No studies available.","sInfo":"Showing _TOTAL_ study(s) (_START_ to _END_)","sLengthMenu":'Display <select>'+
'<option value="10">10</option>'+
'<option value="20">20</option>'+
'<option value="50">50</option>'+
'<option value="100">100</option>'+
'<option value="-1">all</option>'+
'</select> studies.'}});$(theTable).dataTable().fnAdjustColumnSizing();}
else
$(theTable).dataTable().fnClearTable();return theTable;},processSummary:function(summary){var self=this;var typeSummary=[];var catList=$('.jtox-study',self.rootElement);while(catList.length>0){catList[0].parentNode.removeChild(catList[0]);}
for(var s in summary){var sum=summary[s];var top=sum.topcategory.title;if(!top)
continue;var top=top.replace(/ /g,"_");var tab=$('.jtox-study-tab.'+top,self.rootElement)[0];var catname=sum.category.title;if(!catname){typeSummary[top]=sum.count;}
else{var cat=self.createCategory(tab,catname);$(cat).data('jtox-uri',sum.category.uri);}}
$('ul li a',self.rootElement).each(function(i){var data=$(this).data('type');if(!!data){var cnt=typeSummary[data];var el=$(this)[0];el.innerHTML=(self.updateCount(el.innerHTML,cnt));}});var filterTimeout=null;var fFilter=function(ev){if(!!filterTimeout)
clearTimeout(filterTimeout);var field=ev.currentTarget;var tab=$(this).parents('.jtox-study-tab')[0];filterTimeout=setTimeout(function(){var tabList=$('.jtox-study-table',tab);for(var t=0,tlen=tabList.length;t<tlen;++t){$(tabList[t]).dataTable().fnFilter(field.value);}},300);};var tabList=$('.jtox-study-tab');for(var t=0,tlen=tabList.length;t<tlen;t++){var filterEl=$('.jtox-study-filter',tabList[t])[0].onkeydown=fFilter;}},processStudies:function(tab,study,map){var self=this;var cats=[];if(!map){cats[study[0].protocol.category.code]=study;}
else{for(var i=0,slen=study.length;i<slen;++i){var ones=study[i];if(map){if(cats[ones.protocol.category]===undefined){cats[ones.protocol.category.code]=[ones];}
else{cats[ones.protocol.category.code].push(ones);}}}}
for(var c in cats){var onec=cats[c];var aStudy=$('.'+c+'.jtox-study',tab)[0];if(aStudy===undefined)
continue;ccLib.fillTree(aStudy,{title:onec[0].protocol.category.title+" (0)"});var study={};for(var i=0,cl=onec.length;i<cl;++i){$.extend(true,study,onec[i]);if(!ccLib.isEmpty(study.parameters)&&!ccLib.isEmpty(study.effects[0].conditions))
break;}
var theTable=self.ensureTable(tab,study);$(theTable).dataTable().fnAddData(onec);$(theTable).colResizable();}
$('#'+theTable.id+' .jtox-multi').each(function(index){this.style.height=''+this.offsetHeight+'px';});},formatConcentration:function(precision,val,unit){return((precision===undefined||precision===null||"="==precision?"":precision)+val+" "+(unit==null||unit==''?"% (w/w)":unit)).replace(/ /g,"&nbsp;");},processComposition:function(json){var self=this;var tab=$('.jtox-composition',self.rootElement)[0];if($(tab).hasClass('unloaded')){$(tab).removeClass('unloaded');$(tab).empty();}
var prepareFillTable=function(json,panel){var theTable=$('.substances-table',panel);$(theTable).dataTable({"bSearchable":true,"bProcessing":true,"bPaginate":true,"sDom":"rt<Fip>","sPaginate":".dataTables_paginate _paging","bAutoWidth":false,"oLanguage":{"sProcessing":"<img src='"+self.baseUrl+"images/24x24_ambit.gif' border='0'>","sLoadingRecords":"No substances found.","sZeroRecords":"No substances found.","sEmptyTable":"No substances available.","sInfo":"Showing _TOTAL_ substance(s) (_START_ to _END_)",},"aoColumns":[{"sClass":"left","sWidth":"10%","mData":"relation","mRender":function(val,type,full){if(type!='display')
return''+val;var func=("HAS_ADDITIVE"==val)?full.proportion.function_as_additive:"";return'<span class="camelCase">'+val.replace("HAS_","").toLowerCase()+'</span>'+((func===undefined||func===null||func=='')?"":" ("+func+")");}},{"sClass":"camelCase left","sWidth":"15%","mData":"component.compound.name","mRender":function(val,type,full){return(type!='display')?''+val:'<a href="'+full.component.compound.URI+'" target="_blank" title="Click to view the compound"><span class="ui-icon ui-icon-link" style="float: left; margin-right: .3em;"></span></a>'+val;}},{"sClass":"left","sWidth":"10%","mData":"component.compound.einecs",},{"sClass":"left","sWidth":"10%","mData":"component.compound.cas",},{"sClass":"center","sWidth":"15%","mData":"proportion.typical","mRender":function(val,type,full){return type!='display'?''+val.value:self.formatConcentration(val.precision,val.value,val.unit);}},{"sClass":"center","sWidth":"15%","mData":"proportion.real","mRender":function(val,type,full){return type!='display'?''+val.lowerValue:self.formatConcentration(val.lowerPrecision,val.lowerValue,val.unit);}},{"sClass":"center","sWidth":"15%","mData":"proportion.real","mRender":function(val,type,full){return type!='display'?''+val.upperValue:self.formatConcentration(val.upperPrecision,val.upperValue,val.unit);}},{"sClass":"center","bSortable":false,"mData":"component.compound.URI","mRender":function(val,type,full){return!val?'':'<a href="'+self.baseUrl+'substance?type=related&compound_uri='+encodeURIComponent(val)+'" target="_blank">Also contained in...</span></a>';}}]});$(theTable).dataTable().fnAddData(json);return theTable;};var substances={};jToxDataset.processFeatures(json.feature);for(var i=0,cmpl=json.composition.length;i<cmpl;++i){var cmp=json.composition[i];jToxDataset.processEntry(cmp.component,json.feature,fnDatasetValue);var theSubs=substances[cmp.compositionUUID];if(theSubs===undefined)
substances[cmp.compositionUUID]=theSubs={name:"",purity:"",maxvalue:0,uuid:cmp.compositionUUID,composition:[]};theSubs.composition.push(cmp);var val=cmp.proportion.typical;if(cmp.relation=='HAS_CONSTITUENT'&&(theSubs.maxvalue<val.value||theSubs.name=='')){theSubs.name=cmp.component.compound['name']+' '+self.formatConcentration(val.precision,val.value,val.unit);theSubs.maxvalue=val.value;val=cmp.proportion.real;theSubs.purity=(val.lowerValue+'-'+val.upperValue+' '+(val.unit==null||val.unit==''?"% (w/w)":val.unit)).replace(/ /g,"&nbsp;");}}
for(var i in substances){var panel=jToxKit.getTemplate('#jtox-compoblock');tab.appendChild(panel);ccLib.fillTree($('.composition-info',panel)[0],substances[i]);prepareFillTable(substances[i].composition,panel);}},querySummary:function(substanceURI){var self=this;jToxKit.call(self,substanceURI+"/studysummary",function(summary){if(!!summary&&!!summary.facet)
self.processSummary(summary.facet);});},queryComposition:function(substanceURI){var self=this;jToxKit.call(self,substanceURI+"/composition",function(composition){if(!!composition&&!!composition.composition)
self.processComposition(composition);});},querySubstance:function(substanceURI){var self=this;self.baseUrl=ccLib.isNull(self.settings.baseUrl)?jToxKit.grabBaseUrl(substanceURI):self.settings.baseUrl;var rootTab=$('.jtox-substance',self.rootElement)[0];jToxKit.call(self,substanceURI,function(substance){if(!!substance&&!!substance.substance&&substance.substance.length>0){substance=substance.substance[0];substance["showname"]=substance.publicname;if(ccLib.isEmpty(substance.showname))
substance.showname=substance.name;ccLib.fillTree(self.rootElement,substance);jToxKit.call(self,substance.referenceSubstance.uri,function(dataset){if(!!dataset){jToxDataset.processDataset(dataset,null,fnDatasetValue);ccLib.fillTree(rootTab,dataset.dataEntry[0]);}});self.querySummary(substance.URI);self.queryComposition(substance.URI);}});}};return cls;})();window.jToxKit={templateRoot:null,queries:{taskPoll:"/task/<1>",},templates:{},settings:{jsonp:false,crossDomain:false,host:null,timeout:15000,pollDelay:200,onConnect:function(s){},onSuccess:function(s,c,m){},onError:function(s,c,m){if(!!console&&!!console.log)console.log("jToxKit call error ("+c+"): "+m+" from request: ["+s+"]");},},formBaseUrl:function(url){return url.protocol+"://"+url.host+(url.port.length>0?":"+url.port:'')+'/'+url.segments[0]+'/';},init:function(){var self=this;self.initTemplates();$(document).on('click','.jtox-toolkit span.ui-icon-copy',function(e){ccLib.copyToClipboard($(this).data('uuid'));return false;});var url=ccLib.parseURL(document.location);var queryParams=url.params;queryParams.host=self.formBaseUrl(url);self.settings=$.extend(self.settings,queryParams);var initKit=function(element,params){if(params.kit=="study")
new jToxStudy(element,params);if(params.kit=="dataset")
new jToxDataset(element,params);};$('.jtox-toolkit').each(function(i){var dataParams=$.extend(true,$(this).data(),self.settings);if(!dataParams.manualInit){var el=this;if(!ccLib.isNull(dataParams.configFile)){self.call({settings:dataParams},dataParams.configFile,function(config){if(!!config)
dataParams['configuration']=config;initKit(el,dataParams);});}
else
initKit(el,dataParams);}});},initTemplates:function(){var self=this;var root=$('.jtox-template')[0];if(root===undefined){var html='';for(var t in self.templates){html+=self.templates[t];}
root=document.createElement('div');root.className='jtox-template';root.innerHTML=html;document.body.appendChild(root);}
self.templateRoot=root;},getTemplate:function(selector){var el=$(selector,this.templateRoot)[0];if(!!el){var el=$(selector,this.templateRoot)[0].cloneNode(true);el.removeAttribute('id');}
return el;},changeTabsIds:function(root,suffix){$('ul li a',root).each(function(){var id=$(this).attr('href').substr(1);var el=document.getElementById(id);id+=suffix;el.id=id;$(this).attr('href','#'+id);})},copySpan:function(data,message){return;},shortenedData:function(data,message,deflen){var res='';if(ccLib.isNull(deflen))
deflen=5;if(data.toString().length<=deflen){res+=data;}
else{res+='<div class="shortened">'+data+'</div>';if(message!=null)
res+='<span class="ui-icon ui-icon-copy" title="'+message+'" data-uuid="'+data+'"></span>';}
return res;},pollTask:function(task,callback){var self=this;if(task===undefined||task.task===undefined||task.task.length<1){ccLib.fireCallback(self.settings.onError,self,'-1',localMessage.taskFailed);return;}
task=task.task[0];if(task.completed==-1){setTimeout(function(){self.call(task.result,function(newTask){self.pollTask(newTask,callback);});},self.pollDelay);}
else if(!task.error){callback(task.result);}
else{ccLib.fireCallback(self.settings.onError,self,'-1',task.error);}},grabBaseUrl:function(url){if(!ccLib.isNull(url)&&url.indexOf('http')==0)
return this.formBaseUrl(ccLib.parseURL(url));else
return this.settings.host;},call:function(kit,service,callback,adata){var settings=$.extend({"baseUrl":this.settings.host},this.settings);if(kit==null)
kit=this;else
settings=$.extend(true,settings,kit.settings);ccLib.fireCallback(settings.onConnect,kit,service);var method='GET';var accType=settings.jsonp?"application/x-javascript":"application/json";if(adata!==undefined){method='POST';if(typeof adata=="boolean")
adata={};}
else if(settings.jsonp)
adata={media:accType};else
adata={};if(service.indexOf("http")!=0)
service=settings.baseUrl+service;$.ajax(service,{dataType:settings.jsonp?'jsonp':'json',headers:{Accept:accType},crossDomain:settings.crossDomain||settings.jsonp,timeout:settings.timeout,type:method,data:adata,jsonp:settings.jsonp?'callback':false,error:function(jhr,status,error){ccLib.fireCallback(settings.onError,kit,service,status,error);callback(null);},success:function(data,status,jhr){ccLib.fireCallback(settings.onSuccess,kit,service,status,jhr.statusText);callback(data);}});}};$(document).ready(function(){jToxKit.init();});jToxKit.templates['all-dataset']="	  <div id=\"jtox-dataset\">"+
"	    <div class=\"jtox-ds-features\"></div>"+
"	    <div class=\"jtox-ds-control\">"+
"	      Showing from <span class=\"data-field from-field\" data-field=\"pagestart\"> ? </span> to <span class=\"data-field\" data-field=\"pageend\"> ? </span> in pages of <select class=\"data-field\" data-field=\"pagesize\">"+
"          <option value=\"10\" selected=\"yes\">10</option>"+
"          <option value=\"20\">20</option>"+
"          <option value=\"50\">50</option>"+
"          <option value=\"100\">100</option>"+
"          <option value=\"200\">200</option>"+
"          <option value=\"500\">500</option>"+
"        </select> entries"+
"	      <a class=\"paginate_disabled_previous prev-field\" tabindex=\"0\" role=\"button\">Previous</a><a class=\"paginate_enabled_next next-field\" tabindex=\"0\" role=\"button\">Next</a>"+
"	      <input type=\"text\" class=\"filterbox\" placeholder=\"Filter...\" />"+
"	    </div>"+
"	    <div class=\"jtox-ds-tables\">"+
"	      <div class=\"jtox-ds-fixed\">"+
"	        <table></table>"+
"	      </div><div class=\"jtox-ds-variable\">"+
"	        <table></table>"+
"	      </div>"+
"	    </div>"+
"	  </div>"+
"";jToxKit.templates['dataset-one-feature']="    <div id=\"jtox-ds-feature\" class=\"jtox-ds-feature\"><input type=\"checkbox\" checked=\"yes\" class=\"jtox-checkbox\" /><span class=\"data-field jtox-title\" data-field=\"title\"> ? </span></div>"+
"";jToxKit.templates['dataset-download']="    <div id=\"jtox-ds-download\" class=\"jtox-inline jtox-ds-download\">"+
"      <a target=\"_blank\"><img class=\"borderless\"/></a>"+
"    </div>"+
"";jToxKit.templates['dataset-export']="    <div id=\"jtox-ds-export\">"+
"      <div class=\"jtox-inline\">Download dataset as: </div>"+
"      <div class=\"jtox-inline jtox-exportlist\"></div>"+
"    </div>"+
"";jToxKit.templates['dataset-one-detail']="    <table>"+
"      <tbody>"+
"        <tr id=\"jtox-one-detail\">"+
"          <th class=\"right data-field\" data-field=\"title\"> ? </th>"+
"          <td class=\"left data-field\" data-field=\"value\"> ? </td>"+
"        </tr>"+
"      </tbody>"+
"    </table>"+
"";jToxKit.templates['dataset-details-table']="    <table id=\"jtox-details-table\" class=\"jtox-details-table\"></table>"+
"";jToxKit.templates['all-studies']="	  <div id=\"jtox-studies\">"+
"	    <ul>"+
"	      <li><a href=\"#jtox-substance\">IUC Substance</a></li>"+
"	      <li><a href=\"#jtox-composition\">Composition</a></li>"+
"	      <li><a href=\"#jtox-pchem\" data-type=\"P-CHEM\">P-Chem (0)</a></li>"+
"	      <li><a href=\"#jtox-envfate\" data-type=\"ENV_FATE\">Env Fate (0)</a></li>"+
"	      <li><a href=\"#jtox-ecotox\" data-type=\"ECOTOX\">Eco Tox (0)</a></li>"+
"	      <li><a href=\"#jtox-tox\" data-type=\"TOX\">Tox (0)</a></li>"+
"	    </ul>"+
"	    <div id=\"jtox-substance\" class=\"jtox-substance\">"+
"	      <table class=\"dataTable\">"+
"	        <thead>"+
"	          <tr>"+
"	            <th class=\"right jtox-size-third\">IUC Substance name:</th>"+
"	            <td class=\"data-field camelCase\" data-field=\"name\"> ? </td>"+
"	          </tr>"+
"	          <tr>"+
"	            <th class=\"right\">IUC Substance UUID:</th>"+
"	            <td class=\"data-field\" data-field=\"i5uuid\"> ? </td>"+
"	          </tr>"+
"	          <tr>"+
"	            <th class=\"right\">IUC Public name:</th>"+
"	            <td class=\"data-field camelCase\" data-field=\"publicname\"> ? </td>"+
"	          </tr>"+
"	          <tr>"+
"	            <th class=\"right\">Legal entity:</th>"+
"	            <td class=\"data-field\" data-field=\"ownerName\"> ? </td>"+
"	          </tr>"+
"	          <tr>"+
"	            <th class=\"right\">Legal entity UUID:</th>"+
"	            <td class=\"data-field\" data-field=\"ownerUUID\"> ? </td>"+
"	          </tr>"+
"	          <tr>"+
"	            <th class=\"right\">Type substance composition:</th>"+
"	            <td class=\"data-field\" data-field=\"substanceType\"> ? </td>"+
"	          </tr>"+
"	          <tr class=\"borderless-bottom\">"+
"	            <th class=\"right\">IUC Substance Reference Identifier</th>"+
"	            <td></td>"+
"	          </tr>"+
"	          <tr class=\"borderless-top borderless-bottom\">"+
"	            <td class=\"right\">CAS:</td>"+
"	            <td class=\"data-field\" data-field=\"compound.cas\"> ? </td>"+
"	          </tr>"+
"	          <tr class=\"borderless-top borderless-bottom\">"+
"	            <td class=\"right\">EC:</td>"+
"	            <td class=\"data-field\" data-field=\"compound.einecs\"> ? </td>"+
"	          </tr>"+
"	          <tr class=\"borderless-top borderless-bottom\">"+
"	            <td class=\"right\">Chemical name:</td>"+
"	            <td class=\"data-field\" data-field=\"compound.name\"> ? </td>"+
"	          </tr>"+
"	          <tr class=\"borderless-top borderless-bottom\">"+
"	            <td class=\"right\">IUPAC name:</td>"+
"	            <td class=\"data-field\" data-field=\"compound.iupac\"> ? </td>"+
"	          </tr>"+
"	          <tr class=\"borderless-top borderless-bottom\">"+
"	            <td class=\"right\">UUID:</td>"+
"	            <td class=\"data-field\" data-field=\"referenceSubstance.i5uuid\"> ? </td>"+
"	          </tr>"+
"	          <tr class=\"borderless-top\">"+
"	            <td class=\"right\">IUC Subst. identifier used by Legal entity:</td>"+
"	            <td class=\"data-field\" data-field=\"compound.tradename\"> ? </td>"+
"	          </tr>"+
"	        </thead>"+
"	      </table>"+
"	    </div>"+
"	    <div id=\"jtox-composition\" class=\"jtox-composition unloaded\"></div>"+
"	    <div id=\"jtox-pchem\" class=\"jtox-study-tab P-CHEM\">"+
"	      <p><input type=\"text\" class=\"jtox-study-filter ui-input\" placeholder=\"Filter...\" /></p>"+
"	      <h4 class=\"data-field camelCase\" data-field=\"showname\"> ? </h4>"+
"      </div>"+
"	    <div id=\"jtox-envfate\" class=\"jtox-study-tab ENV_FATE\">"+
"	      <p><input type=\"text\" class=\"jtox-study-filter ui-input\" placeholder=\"Filter...\" /></p>"+
"	      <h4 class=\"data-field camelCase\" data-field=\"showname\"> ? </h4>"+
"	    </div>"+
"	    <div id=\"jtox-ecotox\" class=\"jtox-study-tab ECOTOX\">"+
"	      <p><input type=\"text\" class=\"jtox-study-filter ui-input\" placeholder=\"Filter...\" /></p>"+
"	      <h4 class=\"data-field camelCase\" data-field=\"showname\"> ? </h4>"+
"	    </div>"+
"	    <div id=\"jtox-tox\" class=\"jtox-study-tab TOX\">"+
"	      <p><input type=\"text\" class=\"jtox-study-filter ui-input\" placeholder=\"Filter...\" /></p>"+
"	      <h4 class=\"data-field camelCase\" data-field=\"showname\"> ? </h4>"+
"	    </div>"+
"	  </div>"+
"";jToxKit.templates['composition-block']="    <div id=\"jtox-compoblock\" class=\"jtox-compoblock\">"+
"      <table class=\"dataTable composition-info jtox-font-small\">"+
"        <thead>"+
"          <tr><th>Composition name:</th><td class=\"data-field camelCase\" data-field=\"name\"> ? </td></tr>"+
"          <tr><th>Composition UUID:</th><td class=\"data-field\" data-field=\"uuid\"> ? </td></tr>"+
"          <tr><th>Purity of IUC Substance:</th><td class=\"data-field\" data-field=\"purity\"> ? </td></tr>"+
"        </thead>"+
"      </table>"+
"      <table class=\"substances-table\">"+
"        <thead>"+
"          <tr>"+
"            <th>Type</th>"+
"            <th>Name</th>"+
"            <th>EC No.</th>"+
"            <th>CAS No.</th>"+
"            <th>Typical concentration</th>"+
"            <th colspan=\"2\">Concentration ranges</th>"+
"            <th></th>"+
"          </tr>"+
"        </thead>"+
"      </table>"+
"    </div>"+
"";jToxKit.templates['one-study']="    <div id=\"jtox-study\" class=\"jtox-study jtox-foldable folded unloaded\">"+
"      <div class=\"jtox-study-title\"><p class=\"data-field\" data-field=\"title\">? (0)</p></div>"+
"      <table class=\"jtox-study-table\"></table>"+
"    </div>"+
"";